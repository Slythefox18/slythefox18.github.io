<!DOCTYPE html>
<html>
  <head>
    <title>Risk calculator wow</title>
    <style>
      h1 {
        text-align: center;
      }
      #inpContainer {
        display: flex;
        flex-direction: column;
        width: 40%;
        margin: 5px;
      }
      #container {
        font-size: 2rem;
        display: flex;
        flex-direction: row;
        width: 100%;
      }
      input {
        font-size: inherit;
      }
      textarea {
        border: 2px inset gray;
        height: fit-content;
        width: 100%;
        resize: none;
      }
      button {
        font-size: inherit;
        margin-top: 5px;
      }
      #logsContainer {
        width: 100%;
        height: 100%;
      }
    </style>
  </head>
  <body>
    <h1>risk calculator wow yay</h1>
    <div id="container">
      <div id="inpContainer">
        <label for="attacker">attackers #</label>
        <input type="number" id="attacker" />
        <label for="attacked">defenders #</label>
        <input type="number" id="attacked" />
        <button id="step">Step</button>
        <button id="calc">Calculate all</button>
        <button id="reset">RESET</button>
      </div>
      <div id="logsContainer">
        <textarea id="logs" rows="40" readonly></textarea>
      </div>
    </div>

    <script>
      const attacker = document.getElementById("attacker"),
        attacked = document.getElementById("attacked"),
        logs = document.getElementById("logs"),
        goodSound =
          ((document.getElementById("step").onclick = step),
          (document.getElementById("calc").onclick = calc),
          (document.getElementById("reset").onclick = reset),
          new Audio(
            "https://cdn.pixabay.com/download/audio/2025/05/31/audio_69a27fd520.mp3?filename=powerful-cannon-shot-352459.mp3"
          )),
        words = [
          "killed",
          "executed",
          "assassinated",
          "slaughtered",
          "annihilated",
          "slain",
          "wiped out",
          "sacked",
          "murdered",
          "deconstructed",
        ];
      let atk = 0,
        def = 0,
        rollAmnt = 0,
        atkLostTotal = 0,
        defLostTotal = 0;
      function roll() {
        return Math.floor(6 * Math.random()) + 1;
      }
      function get() {
        (atk = Number(attacker.value)), (def = Number(attacked.value));
      }
      function set() {
        (attacker.value = atk), (attacked.value = def);
      }
      function reset() {
        (atk = 0),
          (def = 0),
          (atkLostTotal = 0),
          (defLostTotal = 0),
          set(),
          (logs.value = ""),
          (rollAmnt = 0);
      }
      function s(t) {
        document.body.style.transform = `rotate(${t}deg)`;
      }
      function calc() {
        let e = !1;
        function o() {
          var t;
          !0 === e &&
            (console.log("hi"),
            goodSound.cloneNode(!0).play(),
            (t = 500 * Math.random()),
            setTimeout(o, t));
        }
        get();
        let t = 0;
        let a = window.setInterval(() => {
          (t += 0.5),
            0 == e && ((e = !0), o()),
            s(t),
            360 < t && (window.clearInterval(a), (e = !1), s(0));
        });
        for (s(0); 0 < atk && 0 < def; ) sub();
        addLog("=====FINAL STUFF=====\n"),
          addLog(
            atkLostTotal +
              ` attackers lost
`
          ),
          addLog(
            defLostTotal +
              ` defenders lost
`
          ),
          (logs.scrollTop = logs.scrollHeight),
          set();
      }
      function step() {
        get(), sub(), set();
      }
      function word() {
        return words[Math.floor(Math.random() * words.length)];
      }
      function sub() {
        if (!(atk < 1 || def < 1)) {
          var o = Math.min(atk, 3),
            a = Math.min(def, 2),
            d = [],
            l = [];
          for (let t = 0; t < o; t++) d.push(roll());
          for (let t = 0; t < a; t++) l.push(roll());
          rollAmnt++, d.sort(r), l.sort(r);
          var n = d[1] || -1,
            s = l[1] || -1;
          let t = 0,
            e = 0;
          function r(t, e) {
            return e - t;
          }
          l[0] < d[0] ? e++ : t++,
            -1 != n && -1 != s && (s < n ? e++ : t++),
            (atkLostTotal += t),
            (defLostTotal += e),
            (atk -= t),
            (def -= e),
            addLog(`==========ROLL ${rollAmnt}==========
`),
            addLog(`Attacker got ${JSON.stringify(d)}
`),
            addLog(`Defender got ${JSON.stringify(l)}
`),
            addLog(`${t} attackers ${word()}, ${atk} left\n`),
            addLog(`${e} defenders ${word()}, ${def} left\n`),
            (logs.scrollTop = logs.scrollHeight);
        }
      }
      function addLog(t) {
        logs.value += t;
      }
      set();
    </script>
  </body>
</html>
